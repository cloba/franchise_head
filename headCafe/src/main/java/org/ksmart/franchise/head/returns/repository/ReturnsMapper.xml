<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.ksmart.franchise.head.returns.repository.ReturnsMapper">

	<resultMap id="ReturnsResultMap" type="org.ksmart.franchise.head.returns.model.Returns">
		<id property="returnsCode" column="returns_code"/>
		<result property="ordersCode" column="orders_code"/>
		<result property="specificItemCode" column="specific_item_code"/>
		<result property="returnsReason" column="returns_reason"/>
		<result property="returnsPrice" column="returns_price"/>
		<result property="returnsReportDate" column="returns_report_date"/>
		<result property="returnsHeadCheck" column="returns_head_check"/>
		<result property="returnsHeadCheckDate" column="returns_head_check_date"/>
		<result property="headStaffId" column="head_staff_id"/>
		<result property="returnsHeadCheck" column="returns_head_check"/>
		<result property="returnsReDelivery" column="returns_re_delivery"/>
		<result property="returnsCancel" column="returns_cancel"/>
		<result property="returnsApproval" column="returns_approval"/>
		<result property="returnsApprovalDate" column="returns_approval_date"/>
		
		
	</resultMap>
	
	<!-- 로얄티 리스트 조회 메서드 -->
	<select id="selectReturnsList" resultMap="ReturnsResultMap" parameterType="java.util.Map">
		SELECT 
			returns_code,          orders_code, 
			specific_item_code,    returns_reason, 
			returns_price,         head_staff_id,    
			returns_re_delivery ,  returns_group_code
		FROM `returns`
		<where>
			<if test='search.searchItem != null and search.searchItem != "" '>
				AND ${search.searchKey} like CONCAT('%',#{search.searchItem},'%')
			</if>
		</where>
		<trim prefix="ORDER BY">
			<if test="search.criteria != null or search.criteria != ''">
				${search.criteria} ${search.upDown}
			</if>
		</trim>
	</select>

	<select id="selectReturnDetail" parameterType="java.util.Map" resultMap="ReturnsResultMap">
		SELECT 
			returns_code,        orders_code,              specific_item_code,
			returns_reason,      returns_price,             returns_report_date,              
			returns_head_check,  returns_head_check_date,   head_staff_id, 		 
			returns_cancel,      returns_approval,          returns_approval_date,
			returns_re_delivery, returns_group_code
		FROM 
			`returns`
		WHERE returns_code= #{returns.returnsCode}
	
	</select>
	<update id="updateReturnsApproval" parameterType="java.lang.String">
		UPDATE `returns`
	SET
		returns_approval=#{returnsApprovalIdenfity},
		returns_approval_date=NOW()
	WHERE
		returns_code=#{returnsCode} 
	</update>




</mapper>