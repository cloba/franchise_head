<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.ksmart.franchise.head.royaltyOverdue.repository.RoyaltyOverdueMapper">
	<resultMap type="org.ksmart.franchise.head.royaltyOverdue.model.RoyaltyOverdue" id="RoyaltyOverdueRoyaltyResultMap">
		<id property="royaltyOverdueCode" column="royalty_overdue_code" />
		<result property="contractCode" column="contract_code"/>
		<result property="royaltyOverdueStatus" column="royalty_overdue_status"/>
		<result property="royaltyOverduePaid" column="royalty_overdue_paid"/>
		<result property="royaltyOverduePay_date" column="royalty_overdue_pay_date"/>
		<result property="royaltyOverdueRest" column="royalty_overdue_rest"/>
	</resultMap>
	
	
<!--  0808/17:30 학원마지막 쿼리  	

select * from royalty where royalty_code IN (select royalty_code from royalty where royalty_month = '2016-07' and royalty_code IN (select royalty_code from royalty where royalty_deadline > date_format(now(),'%d') )) -->
	
	<!--로얄티 연체 리스트 조회 쿼리 -->
	<select id="selectRoyaltyOverdueList" parameterType="java.util.Map" resultMap="RoyaltyOverdueRoyaltyResultMap"> 
		SELECT
				royalty_overdue_code,
				contract_code,
				royalty_overdue_status,
				royalty_overdue_paid,
				royalty_overdue_pay_date,
				royalty_overdue_rest
			From 
				royalty_overdue
			<where>
				<if test='search.searchItem != null and search.searchItem != "" '>
					AND ${search.searchKey} like CONCAT('%',#{search.searchItem},'%')
				</if>
			</where>
			<trim prefix="ORDER BY">
				<if test="search.criteria != null or search.criteria != ''">
					${search.criteria} ${search.upDown}
				</if>
			</trim>
	
	
	</select>













</mapper>